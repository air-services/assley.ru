<h1 class="title has-text-weight-normal is-size-2">Добавить книгу</h1>
<form [formGroup]="bookForm">
  <div class="field">
    <label class="label">Название</label>
    <div class="control">
      <input
        class="input"
        formControlName="title"
        type="text"
        placeholder="Введите название книги"
      />
    </div>
  </div>

  <div formArrayName="episodes">
    <h3>Главы</h3>
    <button (click)="addEpisode()">Добавить главу</button>

    <div *ngFor="let episode of episodes.controls; let episodeIndex = index">
      <div [formGroupName]="episodeIndex">
        <input class="input" formControlName="name" />
        <input class="input" formControlName="season" />

        <div class="field">
          <div class="file">
            <label class="file-label">
              <input
                class="file-input"
                type="file"
                name="file"
                (change)="onFileChange($event, episodeIndex)"
              />
              <span class="file-cta">
                <span class="file-icon">
                  <i class="fas fa-upload"></i>
                </span>
                <span class="file-label">
                  Загрузить файл
                </span>
              </span>
            </label>
          </div>
        </div>
      </div>

      <button class="button is-danger" (click)="removeEpisode(episodeIndex)">
        Remove
      </button>
    </div>
  </div>

  <!-- <div class="field">
    <div class="file">
      <label class="file-label">
        <input
          class="file-input"
          type="file"
          name="file"
          (change)="onFileChange($event)"
        />
        <span class="file-cta">
          <span class="file-icon">
            <i class="fas fa-upload"></i>
          </span>
          <span class="file-label">
            Загрузить файл
          </span>
        </span>
      </label>
    </div>
  </div> -->

  <div class="field">
    <label class="label">Жанры</label>
    <div class="control">
      <ng-select
        [items]="resources.genre"
        [multiple]="true"
        [closeOnSelect]="false"
        [searchable]="true"
        bindLabel="name"
        placeholder="Выберите жанры"
        (change)="onSelectGenre($event)"
        (search)="onSearchGenre($event)"
      >
      </ng-select>
    </div>
  </div>

  <div class="field">
    <label class="label">Тэги</label>
    <div class="control">
      <ng-select
        [items]="resources.tag"
        [multiple]="true"
        [closeOnSelect]="false"
        [searchable]="true"
        bindLabel="name"
        placeholder="Выберите тэги"
        (change)="onSelectTag($event)"
        (search)="onSearchTag($event)"
      >
      </ng-select>
    </div>
  </div>

  <div class="field">
    <label class="label">Категории</label>
    <div class="control">
      <ng-select
        [items]="resources.section"
        [multiple]="true"
        [closeOnSelect]="false"
        [searchable]="true"
        bindLabel="name"
        placeholder="Выберите категории"
        (change)="onSelectSection($event)"
        (search)="onSearchSection($event)"
      >
      </ng-select>
    </div>
  </div>

  <div class="field">
    <label class="label">Описание</label>
    <div class="control">
      <textarea
        formControlName="description"
        class="textarea"
        placeholder="Введите описание"
      ></textarea>
    </div>
  </div>
  <div class="field is-grouped">
    <div class="control">
      <button class="button is-success" (click)="onSubmit()">
        Добавить книгу
      </button>
    </div>
  </div>
</form>
